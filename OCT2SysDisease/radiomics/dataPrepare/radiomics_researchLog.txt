# Feb 14th, Sunday, 2021
Think to use 95 radiiomics features to predict hypertension.
1  from the original middle B-scan of size 496x512 with segmented retina, extract 95 radiomics features; (6499 slices)   --done.
2  Use ground truth hypertension with history to divide all data into 10 folds;   -done
   outputDir: /home/hxie1/data/BES_3K/GTs/95radiomics_ODOS_10CV
===============Divide IDs with 95 radiomics features and hypertension tags into 10 folds================
in the clinical GT files of 5208 patients, taggedHBP0 = 1535, taggedHBP1 = 1915, total 3450 patients.
In radiomics dir, there are 3254 unique IDs.
After deleting invalid IDs in radiomics files, ID_HBP_Array remains HBP0=1409, HBP1=1778, total 3187 patients.
valid HBP data set: proportion of 0,1 = [0.4421085660495764,0.5578914339504236]
After erasing repeated ID: Num_response0 = 1409, Num_response1= 1778, total=3187

CV: 0/10: test: 318 patients;  validation: 318 patients;  training: 2551 patients;
CV: 1/10: test: 318 patients;  validation: 319 patients;  training: 2550 patients;
CV: 2/10: test: 319 patients;  validation: 319 patients;  training: 2549 patients;
CV: 3/10: test: 319 patients;  validation: 319 patients;  training: 2549 patients;
CV: 4/10: test: 319 patients;  validation: 319 patients;  training: 2549 patients;
CV: 5/10: test: 319 patients;  validation: 319 patients;  training: 2549 patients;
CV: 6/10: test: 319 patients;  validation: 319 patients;  training: 2549 patients;
CV: 7/10: test: 319 patients;  validation: 319 patients;  training: 2549 patients;
CV: 8/10: test: 319 patients;  validation: 318 patients;  training: 2550 patients;
CV: 9/10: test: 318 patients;  validation: 318 patients;  training: 2551 patients;

3  Use logistic regession to choose features from 95 features;   --done.
   Using 95 radiomics with logistic regression on all data including training, validation and test data, with bfgs optimization method,
   can get 59% accuracy on all data, which can be regarded as training accuracy.
   total 6363 samples including OD/OS, excluded 777 samples whose z-score > 3.

4  use elasticNet to predict result on test folds;


# Feb 9th, Tuesday, 2021
Radiomics = Genomics
Radiomic data has the potential to uncover disease characteristics that fail to be appreciated by the naked eye.
Logistic Regression + L1/L2 regulirization = elasticNet

1  thickness images: 9x31x25
2  texture image with sigmented mask: 31xSegHx512
3  some features:
   GLCM: is a direction x n x n matrix, where n is the number of gray levels,
   Gray Level Run Length Matrix (GLRLM):  a matrix of direction x n x Length, where n is the number of gray levels.
   Gray Level Size Zone Matrix (GLSZM):   a matrix of n x maxZoneSize, where n is the number of gray levels.
   Gray Level Dependece Matrix (GLDM):    a matrix of n x maxDepenceNum, where n is the number of gray levels.
   Neighboring Gray Tone Difference Matrix (NGTDM):  a matrix of nx4, where n is the number of gray levels.


4  radiomics feature extracion at whole dataset;
5  use elasticNet for feature selection at whole dataset;
6  use 10-fold crossing-validation to measure performance;


Notes:
GLCM: The function creates a gray-level co-occurrence matrix (GLCM) by calculating how often a pixel with the intensity
      (gray-level) value i occurs in a specific spatial relationship to a pixel with the value j.

Questions:
1  which texture image as input for radiomics feature extraction:
   A. enface image of 9x31x512: the pixel resolution of H and W has 11.3 times difference; It has layer information.
   B. original OCT image of 31x496x512 with segmented OCT layers:
      B1. if we choose the whole segmented retina layer, we may has not the layer information for different layers.
      B2. if we want to preserve the segmented layer information, how do we do?
   C. enface image of 9x31x25:  the pixel resolution of H and W are same, but texture image is blurry.

   An initial try: use the middle B-scan of 496x512 with segmented retina mask.
       pros: the best pixel resolution gives the best information for texture.
       cons: it ignored other B-scans.
   Our previous experiment showed that thickness information is not powerful enough to predict hypertension.
   If OCT image had the prediction capability of hypertension, the not powerful above may implies that the transform
   from OCT to thickness losses some more powerful information. Therefore, we hope the clearer texture information may help.

# Feb 13th, Saturday, 2021
===============================================
Radiomic feature list:
===============================================
original_firstorder_10Percentile:7.2
original_firstorder_90Percentile:45.2
original_firstorder_Energy:6448.0
original_firstorder_Entropy:0.9182958340544889
original_firstorder_InterquartileRange:29.0
original_firstorder_Kurtosis:1.667601606969319
original_firstorder_Maximum:46.0
original_firstorder_Mean:21.333333333333332
original_firstorder_MeanAbsoluteDeviation:14.444444444444445
original_firstorder_Median:14.0
original_firstorder_Minimum:0.0
original_firstorder_Range:46.0
original_firstorder_RobustMeanAbsoluteDeviation:11.795918367346939
original_firstorder_RootMeanSquared:26.766479866512974
original_firstorder_Skewness:0.47900364443608484
original_firstorder_TotalEnergy:6448.0
original_firstorder_Uniformity:0.5555555555555556
original_firstorder_Variance:261.33333333333337
original_glcm_Autocorrelation:2.0
original_glcm_ClusterProminence:1.185185185185186
original_glcm_ClusterShade:0.5925925925925933
original_glcm_ClusterTendency:0.8888888888888891
original_glcm_Contrast:0.0
original_glcm_Correlation:0.999999999999999
original_glcm_DifferenceAverage:0.0
original_glcm_DifferenceEntropy:-3.2034265038149176e-16
original_glcm_DifferenceVariance:0.0
original_glcm_Id:1.0
original_glcm_Idm:1.0
original_glcm_Idmn:1.0
original_glcm_Idn:1.0
original_glcm_Imc1:-0.9999999999999996
original_glcm_Imc2:0.91686441084635
original_glcm_InverseVariance:0.0
original_glcm_JointAverage:1.3333333333333333
original_glcm_JointEnergy:0.5555555555555556
original_glcm_JointEntropy:0.9182958340544889
original_glcm_MaximumProbability:0.6666666666666666
original_glcm_SumEntropy:0.9182958340544889
original_glcm_SumSquares:0.2222222222222222
original_gldm_DependenceEntropy:1.8365916681089776
original_gldm_DependenceNonUniformity:5.0
original_gldm_DependenceNonUniformityNormalized:0.5555555555555556
original_gldm_DependenceVariance:0.2222222222222222
original_gldm_GrayLevelNonUniformity:5.0
original_gldm_GrayLevelVariance:0.2222222222222222
original_gldm_HighGrayLevelEmphasis:2.0
original_gldm_LargeDependenceEmphasis:5.666666666666667
original_gldm_LargeDependenceHighGrayLevelEmphasis:11.333333333333334
original_gldm_LargeDependenceLowGrayLevelEmphasis:4.25
original_gldm_LowGrayLevelEmphasis:0.75
original_gldm_SmallDependenceEmphasis:0.2037037037037037
original_gldm_SmallDependenceHighGrayLevelEmphasis:0.40740740740740744
original_gldm_SmallDependenceLowGrayLevelEmphasis:0.1527777777777778
original_glrlm_GrayLevelNonUniformity:1.6666666666666667
original_glrlm_GrayLevelNonUniformityNormalized:0.5555555555555556
original_glrlm_GrayLevelVariance:0.2222222222222222
original_glrlm_HighGrayLevelRunEmphasis:2.0
original_glrlm_LongRunEmphasis:9.0
original_glrlm_LongRunHighGrayLevelEmphasis:18.0
original_glrlm_LongRunLowGrayLevelEmphasis:6.75
original_glrlm_LowGrayLevelRunEmphasis:0.75
original_glrlm_RunEntropy:0.9182958340544889
original_glrlm_RunLengthNonUniformity:3.0
original_glrlm_RunLengthNonUniformityNormalized:1.0
original_glrlm_RunPercentage:0.3333333333333333
original_glrlm_RunVariance:0.0
original_glrlm_ShortRunEmphasis:0.1111111111111111
original_glrlm_ShortRunHighGrayLevelEmphasis:0.2222222222222222
original_glrlm_ShortRunLowGrayLevelEmphasis:0.08333333333333333
original_glszm_GrayLevelNonUniformity:1.6666666666666667
original_glszm_GrayLevelNonUniformityNormalized:0.5555555555555556
original_glszm_GrayLevelVariance:0.2222222222222222
original_glszm_HighGrayLevelZoneEmphasis:2.0
original_glszm_LargeAreaEmphasis:9.0
original_glszm_LargeAreaHighGrayLevelEmphasis:18.0
original_glszm_LargeAreaLowGrayLevelEmphasis:6.75
original_glszm_LowGrayLevelZoneEmphasis:0.75
original_glszm_SizeZoneNonUniformity:3.0
original_glszm_SizeZoneNonUniformityNormalized:1.0
original_glszm_SmallAreaEmphasis:0.1111111111111111
original_glszm_SmallAreaHighGrayLevelEmphasis:0.2222222222222222
original_glszm_SmallAreaLowGrayLevelEmphasis:0.08333333333333333
original_glszm_ZoneEntropy:0.9182958340544889
original_glszm_ZonePercentage:0.3333333333333333
original_glszm_ZoneVariance:0.0
original_shape2D_Elongation:0.21660386621246067
original_shape2D_MajorAxisLength:869.2154369036384
original_shape2D_MaximumDiameter:488.53249636027283
original_shape2D_MeshSurface:7.5
original_shape2D_MinorAxisLength:188.27542420488126
original_shape2D_Perimeter:20.485281374238568
original_shape2D_PerimeterSurfaceRatio:2.7313708498984757
original_shape2D_PixelSurface:9.0
original_shape2D_Sphericity:0.4739075527167048
=============================================

===========Total 95 features============
all features are stored in array in above order.


===============================================
